<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Kexin Tang">
    
    <title>
        
            DDIA cookbook - (9)Ordering |
        
        Kexin&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/otter-solid.svg">
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"kexintang.xyz","root":"/","language":"en","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#ff9f43","logo":null,"favicon":"/images/otter-solid.svg","avatar":"/images/OtterAvatar.jpg","font_size":null,"font_family":null,"hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"闲云野鹤||A lone cloud","font_color":null,"hitokoto":false},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"side_tools":{},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":false,"auto":false,"custom_label_list":[]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":false},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original article title","author":"Original article author","link":"Original article link"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
               Kexin&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               target="_blank" rel="noopener" href="https://drive.google.com/file/d/13-0bw5teEW1AYoNnH5pRfsbnT48hkBJr/view?usp=drive_link"
                            >
                                RESUME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       target="_blank" rel="noopener" href="https://drive.google.com/file/d/13-0bw5teEW1AYoNnH5pRfsbnT48hkBJr/view?usp=drive_link">RESUME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">DDIA cookbook - (9)Ordering</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/OtterAvatar.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">Kexin Tang</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-11-03 14:55:41</span>
        <span class="mobile">2023-11-03 14:55</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-12-08 12:13:41</span>
    </span>
    
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/System-Design/">System Design</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/DDIA/">DDIA</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <h1 id="Ordering-and-Causality"><a href="#Ordering-and-Causality" class="headerlink" title="Ordering and Causality"></a>Ordering and Causality</h1><p>Causality imposes an ordering on events: cause comes before effect; a message is sent before that message is received; the question comes before the answer. And, like in real life, one thing leads to another: one node reads some data and then writes something as a result, another node reads the thing that was written and writes something else in turn, and so on.</p>
<h2 id="Causal-order-ne-Total-order"><a href="#Causal-order-ne-Total-order" class="headerlink" title="Causal order &ne; Total order"></a>Causal order &ne; Total order</h2><p><strong>Total order</strong> &rarr; ordering by time, every pair of events can be placed in some order.</p>
<p><strong>Causal ordering is only a partial order</strong> - sometimes events happen with order, sometimes are concurrently.</p>
<blockquote>
<p>In a <strong>linearizable</strong> system, we have a <strong>total order</strong> of operations: if the system behaves as if there is only a single copy of the data, and every operation is atomic, this means that for any two operations we can always say which one happened first. It’s just like there is a single timeline along which all operations are totally ordered.</p>
</blockquote>
<p>It maybe very hard to understand the difference. Let’s use twitter as an example. If you post a twitte, then A, B and C comment your post.</p>
<ul>
<li>Causal order (<em>some events have causality restriction &#x2F; time order, but some may be concurrent, which leads to unkonwn time order</em>)<ul>
<li>ABC need to see your post first, then comment, so “your post” is the cause, and “comments from A, B and C” is the effect (can be either concurrent or sequential).</li>
<li>Causal order only guarantees “post&rarr;A comment”, “post&rarr;B comment” and “post&rarr;C comment”.</li>
<li>That means in A’s phone, maybe the comments order is ABC, but in B’s phone, the comments order is BCA.</li>
</ul>
</li>
<li>Total order (<em>in any nodes&#x2F;views, events have the same time order, no need to have causality</em>)<ul>
<li>It only guarantees that in ABC’s phones, all events have the same order, even they aren’t reasonable.</li>
<li>For example, the events are “A comment&rarr;C comment&rarr;post&rarr;B comment”.</li>
</ul>
</li>
</ul>
<p><strong>Causal ordering doesn’t imply total ordering, and total ordering doesn’t imply causal ordering as well</strong>.</p>
<p><img  
                     lazyload
                     alt="image"
                     data-src="https://i.imgur.com/F2QKuWR.jpg"
                      alt="causal ordering"
                ><br><img  
                     lazyload
                     alt="image"
                     data-src="https://i.imgur.com/KoidOEK.jpg"
                      alt="total ordering"
                ></p>
<h2 id="Linearizability-is-stronger-than-causal-consistency"><a href="#Linearizability-is-stronger-than-causal-consistency" class="headerlink" title="Linearizability is stronger than causal consistency"></a>Linearizability is stronger than causal consistency</h2><p><strong>Linearizability implies causality</strong>.</p>
<p><strong>Linearizability is not the only way of preserving causality</strong>. A system can be causally consistent without incurring the performance hit of making it linearizable. In fact, <strong>causal consistency is the strongest possible consistency model that does not slow down due to network delays, and remains available in the face of network failures</strong>.</p>
<blockquote>
<p>In order to maintain causality, you need to know which operation happened before which other operation. This is a partial order: concurrent operations may be processed in any order, but if one operation happened before another, then they must be processed in that order on every replica. Thus, when a replica processes an operation, it must ensure that all causally preceding operations (all operations that happened before) have already been processed.</p>
</blockquote>
<hr>
<h1 id="Sequence-Number-Ordering"><a href="#Sequence-Number-Ordering" class="headerlink" title="Sequence Number Ordering"></a>Sequence Number Ordering</h1><p>Although causality is an important theoretical concept, actually keeping track of all causal dependencies can become impracticable. In many applications, clients read lots of data before writing something, and then it is not clear whether the write is causally dependent on all or only some of those prior reads. Explicitly tracking all the data that has been read would mean a large overhead.</p>
<p>We can use <strong>sequence numbers</strong> or <strong>logic timestamps</strong> to order events. These sequence numbers also provide total order: because every event has its own sequence number, so we can compare any two of them.</p>
<h2 id="Lamport-timestamps"><a href="#Lamport-timestamps" class="headerlink" title="Lamport timestamps"></a>Lamport timestamps</h2><p><img  
                     lazyload
                     alt="image"
                     data-src="https://i.imgur.com/nTy4rV0.png"
                      alt="Lamport Timestamp"
                ></p>
<p>Each node has a unique identifier, and each node keeps a counter of the number of operations it has processed. The Lamport timestamp is then simply a pair of (counter, node ID). Two nodes may sometimes have the same counter value, but by including the node ID in the timestamp, each timestamp is made unique.</p>
<p>A Lamport timestamp bears no relationship to a physical time-of-day clock, but it provides total ordering: <strong>if you have two timestamps, the one with a greater counter value is the greater timestamp; if the counter values are the same, the one with the greater node ID is the greater timestamp</strong>.</p>
<h2 id="Lamport-timestamps-vs-Version-vector"><a href="#Lamport-timestamps-vs-Version-vector" class="headerlink" title="Lamport timestamps vs Version vector"></a>Lamport timestamps vs Version vector</h2><p>Although there are some similarities, they have a different purpose:</p>
<ul>
<li>Version vectors can distinguish whether two operations are concurrent or whether one is causally dependent on the other</li>
<li>Lamport timestamps always enforce a total ordering</li>
</ul>
<p>From the total ordering of Lamport timestamps, you cannot tell whether two operations are concurrent or whether they are causally dependent. The advantage of Lamport timestamps over version vectors is that they are more compact.</p>
<h2 id="Timestamp-ordering-is-not-sufficient"><a href="#Timestamp-ordering-is-not-sufficient" class="headerlink" title="Timestamp ordering is not sufficient"></a>Timestamp ordering is not sufficient</h2><p>The problem here is that the total order of operations only emerges after you have collected all of the operations. If another node has generated some operations, but you don’t yet know what they are, you cannot construct the final ordering of operations: the unknown operations from the other node may need to be inserted at various positions in the total order.</p>
<p>In order to implement something meet uniqueness constraint, it’s not sufficient to have a total ordering of operations—<strong>you also need to know when that order is finalized</strong>. This idea of knowing when your total order is finalized is captured in the topic of <strong>total order broadcast</strong>.</p>
<hr>
<h1 id="Total-Order-Broadcast"><a href="#Total-Order-Broadcast" class="headerlink" title="Total Order Broadcast"></a>Total Order Broadcast</h1><p>Total order broadcast is usually described as a protocol for exchanging messages between nodes. Informally, it requires that two safety properties always be satisfied:</p>
<ul>
<li>Reliable delivery &rarr; No messages are lost: if a message is delivered to one node, it is delivered to all nodes.</li>
<li>Totally ordered delivery &rarr; Messages are delivered to every node in the same order.</li>
</ul>
<blockquote>
<p>A correct algorithm for total order broadcast must ensure that the reliability and ordering properties are always satisfied, even if a node or the network is faulty. Of course, messages will not be delivered while the network is interrupted, but an algorithm can keep retrying so that the messages get through when the network is eventually repaired.</p>
</blockquote>
<h2 id="Use-case"><a href="#Use-case" class="headerlink" title="Use case"></a>Use case</h2><p>Total order broadcast is exactly what you need for database replication: if every message represents a write to the database, and every replica processes the same writes in the same order, then the replicas will remain consistent with each other.</p>
<p>Similarly, total order broadcast can be used to implement serializable transactions: if every message represents a deterministic transaction to be executed as a stored procedure, and if every node processes those messages in the same order, then the partitions and replicas of the database are kept consistent with each other.</p>
<p>An important aspect of total order broadcast is that <strong>the order is fixed at the time the messages are delivered, a node is not allowed to retroactively insert a message into an earlier position in the order if subsequent messages have already been delivered</strong>. This fact makes total order broadcast stronger than timestamp ordering.</p>
<h2 id="Implementing-linearizable-storage-using-total-order-broadcast"><a href="#Implementing-linearizable-storage-using-total-order-broadcast" class="headerlink" title="Implementing linearizable storage using total order broadcast"></a>Implementing linearizable storage using total order broadcast</h2><p>Imagine we have a system for register unique username. For every possible username, you can have a linearizable register with an atomic compare-and-set operation.</p>
<p>You can implement such a linearizable compare-and-set operation as follows by using total order broadcast as an append-only log:</p>
<ol>
<li>Append a message to the log, tentatively indicating the username you want to claim.</li>
<li>Total order broadcast, and wait for the message you appended to be delivered back to you.</li>
<li>Check for any messages claiming the username that you want. If the first message for your desired username is your own message, then you are successful: you can commit the username claim (perhaps by appending another message to the log) and acknowledge it to the client. If the first message for your desired username is from another user, you abort the operation.</li>
</ol>
<p>Because messages are delivered to all nodes in the same order (total order broadcast), if there are several concurrent writes, all nodes will agree on which one came first (who get the username).</p>
<blockquote>
<p>Imagine A, B and C wants to use username “hello world”. No matter who sends the message first, because we use total order broadcast, so if the total order is B-&gt;A-&gt;C, then all nodes will have the same order, then B wins.</p>
</blockquote>
<h2 id="Implementing-total-order-broadcast-using-linearizable-storage"><a href="#Implementing-total-order-broadcast-using-linearizable-storage" class="headerlink" title="Implementing total order broadcast using linearizable storage"></a>Implementing total order broadcast using linearizable storage</h2><p>The algorithm is simple: for every message you want to send through total order broadcast, you increment-and-get the linearizable integer, and then attach the value you got from the register as a sequence number to the message. You can then send the message to all nodes (resending any lost messages), and the recipients will deliver the messages consecutively by sequence number.</p>
<p>Note that unlike Lamport timestamps, the numbers you get from incrementing the linearizable register form a sequence with no gaps. Thus, if a node has delivered message 4 and receives an incoming message with a sequence number of 6, it knows that it must wait for message 5 before it can deliver message 6. The same is not the case with Lamport timestamps—in fact, this is the key difference between total order broadcast and timestamp ordering.</p>
<blockquote>
<p>Because the linearizable storage is no gap, so if I receive message 4 and message 6, which means message 5 also be used by someone else, but I havn’t receive it, I need to wait message 5 then deliver message 6.</p>
</blockquote>

            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/System-Design/">#System Design</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/DDIA/">#DDIA</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2023/11/03/DDIA-cookbook-9-Distributed-Transactions-and-Consensus/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">DDIA cookbook - (9)Distributed Transactions and Consensus</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/11/03/DDIA-cookbook-9-Linearizability/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">DDIA cookbook - (9)Linearizability</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Ordering-and-Causality"><span class="nav-number">1.</span> <span class="nav-text">Ordering and Causality</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Causal-order-ne-Total-order"><span class="nav-number">1.1.</span> <span class="nav-text">Causal order ≠ Total order</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linearizability-is-stronger-than-causal-consistency"><span class="nav-number">1.2.</span> <span class="nav-text">Linearizability is stronger than causal consistency</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sequence-Number-Ordering"><span class="nav-number">2.</span> <span class="nav-text">Sequence Number Ordering</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Lamport-timestamps"><span class="nav-number">2.1.</span> <span class="nav-text">Lamport timestamps</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lamport-timestamps-vs-Version-vector"><span class="nav-number">2.2.</span> <span class="nav-text">Lamport timestamps vs Version vector</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Timestamp-ordering-is-not-sufficient"><span class="nav-number">2.3.</span> <span class="nav-text">Timestamp ordering is not sufficient</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Total-Order-Broadcast"><span class="nav-number">3.</span> <span class="nav-text">Total Order Broadcast</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Use-case"><span class="nav-number">3.1.</span> <span class="nav-text">Use case</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Implementing-linearizable-storage-using-total-order-broadcast"><span class="nav-number">3.2.</span> <span class="nav-text">Implementing linearizable storage using total order broadcast</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Implementing-total-order-broadcast-using-linearizable-storage"><span class="nav-number">3.3.</span> <span class="nav-text">Implementing total order broadcast using linearizable storage</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2023</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">Kexin Tang</a>
            
        </div>
        
            <script async data-pjax
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    Visitor Count&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    Totalview&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>





    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-block.js"></script>




    
<script src="/js/lazyload.js"></script>



<div class="post-scripts pjax">
    
        
<script src="/js/post-helper.js"></script>

        
            
<script src="/js/libs/anime.min.js"></script>

        
        
            
<script src="/js/toc.js"></script>

        
    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
